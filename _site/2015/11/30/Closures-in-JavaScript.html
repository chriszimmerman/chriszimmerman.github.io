<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>House of Black and White</title>
		<link rel="stylesheet" href="/stylesheets/hyde.css">
    <link rel="stylesheet" href="/stylesheets/styles.css">
    <link rel="stylesheet" href="/stylesheets/pygment_trac.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script src="/javascripts/respond.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <!--[if lt IE 8]>
    <link rel="stylesheet" href="stylesheets/ie.css">
    <![endif]-->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
		<link href='http://blog.chriszimmerman.net/feed.xml' rel='alternate' type='application/atom+xml'>
  </head>
  <body>
	<div class="sidebar">
	</div>
	<div class="wrapper">
		<section>
			<div id="title">
				<span>
					<h1><a href="/">House of Black and White</a>
						<a href='/feed.xml'><img length='20' width='20' src='/images/rss3.jpg' /></a>
					</h1>
				</span>
				<p></p>
				<hr>
				<span class="credits left">Project maintained by <a href="https://github.com/chriszimmerman">chriszimmerman</a></span>
				<span class="credits right">Theme by <a href="https://twitter.com/michigangraham">mattgraham</a> </span>
			</div>
			<h1 id="closures-in-javascript">Closures in JavaScript</h1>

<p>In a previous post, I discussed some subtleties in regard to different ways to define functions in JavaScript, as well as a number of JavaScript features and how they relate to the various ways functions can be defined. I want to build upon that last post and discuss another interesting feature of JavaScript: closures. </p>

<p>Closures seem to be one of those concepts that people have difficulty grasping until they’re shown how simple they really are. Most people seem to agree that they grasped closures more easily when shown examples.</p>

<p>Here is some code:</p>

<pre><code>function race(distance) {
	var totalDistance = 0;
	var move = function() { 
		totalDistance += distance; 
		alert("Moved " + distance + " for " + totalDistance + " total.");
	};

	return move;
}
</code></pre>

<p>Within the function <code>race</code> I create a function called <code>move</code> and return it. In JavaScript, this is nothing special. There’s not really anything crazy going on here. A parameter is passed into <code>race</code>, there are some assignments, and there is an alert within the returned function.</p>

<p>With this function available, I’ll write some more code:</p>

<pre><code>var walker = race(2);
walker(); //Moved 2 for 2 total.
walker(); //Moved 2 for 4 total.
</code></pre>

<p>First I call race, passing in a value of 2, and assign the result to <code>walker</code>. <code>walker</code> now references a function.</p>

<p>Within <code>race</code>, when <code>move</code> is created, it knows about the local variables within <code>race</code>. This is due to the fact that JavaScript has <a href="https://en.wikipedia.org/wiki/Scope_%28computer_science%29#Lexical_scope_vs._dynamic_scope">lexical scoping</a> with <a href="https://en.wikipedia.org/wiki/Scope_%28computer_science%29#Function_scope">function scope</a>. As a result, a function that is created will have access to the variables within the parent function, even after the parent function terminates.</p>

<p>At the start of <code>race</code>, <code>totalDistance</code> is set to 0. It ALSO knows about any parameters passed into the function. In our case the parameter is <code>distance</code>, whose value is 2.</p>

<p>When I invoke <code>walker</code> the first time, it knows that <code>totalDistance</code> is 0. After all, that was the value when the parent function returned. It adds <code>distance</code>, whose value was also 2 when the parent function terminated, to <code>totalDistance</code>, giving it a total of 2. The alert then gets called.</p>

<p>I invoke <code>walker</code> again. <code>walker</code> still knows about the same variables as it did before. It knows that <code>distance</code> has a value of 2 and <code>totalDistance</code> also has a value of 2. <code>distance</code> is added to <code>totalDistance</code> giving <code>totalDistance</code> a value of 4. The alert is called again.</p>

<h2 id="what-is-a-closure">What is a closure?</h2>

<p>Defining what a closure is can be difficult. Here’s how <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Closures">Mozilla</a> defines them:</p>

<p><strong>Closures are functions that refer to independent (free) variables. In other words, the function defined in the closure ‘remembers’ the environment in which it was created.</strong></p>

<p>The way I see it, three things are needed for a closure:</p>

<pre><code>1) A containing function.
2) An environment (read: variables) within #1.
3) A function returned by #1 that knows about #2.
</code></pre>

<p>Since Mozilla refers to the containing function as the closure, I would say that the product of a closure is a function that has access to an environment from a function that is now terminated.</p>

<h2 id="a-practical-application-for-closures---information-hiding">A practical application for closures - information hiding</h2>

<p>I’d like to show you how closures are great for hiding information. Look at the following function:</p>

<pre><code>function greeter(name) {
	var nice = function() {
		alert("Why, hello there " + name + "!");
	};

	var ecstatic = function() {
		alert("OMG " + capitalize() + " IS HERE!");
	};

	var capitalize = function() {
		return name.toUpperCase();	
	};

	return {
		nice: nice,
		ecstatic: ecstatic
	};
}
</code></pre>

<p>I’ve created a greeter module that has a few functions for performing different types of greetings. Here is an example of it in use:</p>

<pre><code>var jarvis = greeter("Chris");

jarvis.nice(); //Why, hello there Chris!
jarvis.ecstatic(); //OMG CHRIS IS HERE!
</code></pre>

<p>Here’s the cool thing. I’ll try and call <code>capitalize</code>, also a function defined in <code>greeter</code>:</p>

<pre><code>jarvis.capitalize(); //TypeError: jarvis.capitalize is not a known function
</code></pre>

<p>You can return JavaScript objects that hold multiple functions that reference the same closure. <code>nice</code> and <code>ecstatic</code> can access <code>capitalize</code> because THEY know about it, but we cannot access it from the outside. This makes closures great for information hiding. </p>

<h2 id="conclusion">Conclusion</h2>

<p>As I said before, closures appear to be a difficult concept to grasp, but that is just a deception. When you know about a few prerequisite concepts and then are shown some examples, grasping closures becomes much easier.</p>

<p>I have included references to other resources that aided me in learning about closures. Feel free to check them out below.</p>

<h2 id="resources">Resources</h2>

<p><a href="http://stackoverflow.com/questions/111102/how-do-javascript-closures-work">Stack Overflow</a></p>

<p><a href="https://javascriptweblog.wordpress.com/2010/10/25/understanding-javascript-closures/">JavaScript, JavaScript…</a></p>

<p><a href="http://stackoverflow.com/questions/1047454/what-is-lexical-scope">What is Lexical Scope?</a></p>

<p><a href="http://spin.atomicobject.com/2014/10/20/javascript-scope-closures/">JavaScript Scope - Lexical Scoping, Closures, &amp; Controlling Context</a></p>

<p><a href="https://en.wikipedia.org/wiki/Scope_%28computer_science%29#Lexical_scope_vs._dynamic_scope">Lexical scope vs dynamic scope (Wikipedia)</a></p>

<p><a href="https://en.wikipedia.org/wiki/Scope_%28computer_science%29#Function_scope">Function scope (Wikipedia)</a>.</p>

<p><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Closures">Closures - Mozilla</a></p>


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-69251773-1', 'auto');
  ga('send', 'pageview');

</script>

		</section>

		
			<div id="disqus_thread"></div>
			<script type="text/javascript">
					/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
					var disqus_shortname = 'houseofblackandwhite'; // required: replace example with your forum shortname

					/* * * DON'T EDIT BELOW THIS LINE * * */
					(function() {
							var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
							dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
							(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
					})();
			</script>
			<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
		
	</div>

    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
</body>
</html>
