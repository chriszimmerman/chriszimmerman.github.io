<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>House of Black and White</title>
		<link rel="stylesheet" href="/stylesheets/hyde.css">
    <link rel="stylesheet" href="/stylesheets/styles.css">
    <link rel="stylesheet" href="/stylesheets/pygment_trac.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script src="/javascripts/respond.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <!--[if lt IE 8]>
    <link rel="stylesheet" href="stylesheets/ie.css">
    <![endif]-->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
		<link href='http://blog.chriszimmerman.net/feed.xml' rel='alternate' type='application/atom+xml'>
  </head>
  <body>
	<div class="sidebar">
	</div>
	<div class="wrapper">
		<section>
			<div id="title">
				<span>
					<h1><a href="/">House of Black and White</a>
						<a href='/feed.xml'><img length='20' width='20' src='/images/rss3.jpg' /></a>
					</h1>
				</span>
				<p></p>
				<hr>
				<span class="credits left">Project maintained by <a href="https://github.com/chriszimmerman">chriszimmerman</a></span>
				<span class="credits right">Theme by <a href="https://twitter.com/michigangraham">mattgraham</a> </span>
			</div>
			<h1 id="game-programming-in-c-with-xna">Game Programming in C# With XNA</h1>

<p>Every year for the past few years I’ve been going to PAX East in Boston. Every time, I get inspired to make video games but never actually act on that inspiration. I don’t know if it’s due to A) a lack of original ideas, B) poor artistic skill, C) laziness, or D) all of the above.</p>

<p>Shortly after my trip to PAX East in March of this year, I started a <a href="https://class.coursera.org/gameprogramming-002">Coursera class</a> about game programming in C#. In this class, I learned about writing C# games using Microsoft’s XNA Framework. The class was aimed at people who have never done programming before, but that was fine. Because I already knew the language features of C# taught in the class, I was able to focus on learning about XNA objects and APIs, as well as game-programming-specific concepts like collision detection and calculating sprite velocities. A few of the games I created were a simple blackjack game and a game where you are a hamburger that shoots french fries at teddy bears while they bounce around and shoot projectiles at you.</p>

<p>I would like to share what I learned in the course from the XNA and game development perspective. </p>

<h2 id="the-xna-framework">The XNA Framework</h2>

<p>Microsoft’s XNA <a href="https://www.microsoft.com/en-us/download/details.aspx?id=20914">XNA’s Not Acronymed</a> Framework contains objects that make it relatively easy to create video games. There are objects for handling keyboard and mouse input, getting mouse state, drawing sprites on the screen, and working with sprite velocities, to name a few.</p>

<p>The <code>Mouse</code> and <code>MouseState</code> classes allow you to get information about mouse position and button clicks. The <code>Texture2D</code> class contains information related to a grid of pixels that compose a sprite. The <code>Rectangle</code> class allows you to access information about the rectangle that represents the sprite, such as length, width, X position, Y, position, upper left corner, and so on. The <code>Vector2</code> object is a commonly used object that defines a vector used in game physics.</p>

<p>One thing I dislike about game programming in XNA is that it seems difficult to do great OO programming. In the games I’ve done, I work out of a giant Game class. I have other classes for objects in my games, but it seems like a lot of stuff exists in my <code>Game</code> class. <code>Game</code> has its fingers in a lot of pies with having <code>Initialize(), LoadContent(), UnloadContent(), Update(),</code> and <code>Draw()</code> methods. I feel like it has too much responsibility. I suppose the game needs to simultaneously update the visuals of the game and the unseen logic, but I feel like that violates the Single Responsibility Principle because I see those two tings as two different responsibilities. </p>

<h2 id="fundamental-game-concepts">Fundamental Game Concepts</h2>

<h3 id="the-game-loop">The Game Loop</h3>

<p>One of the most fundamental concepts in game programming is the game loop. The game loop constantly runs, checking for user input and updating the environment. For example, the game loop may have code to draw a bullet sprite from a spaceship when the left mouse button is pressed. There may be code to check for when a bullet sprite comes into contact with an alien sprite and play an explosion animation when that occurs. The game loop repeats indefinitely until the game is terminated.</p>

<p>In pseudocode, the game loop might look something like this:</p>

<pre><code>while(gameIsRunning){
	CheckForInputFromUser();
	UpdateInternalGameState();
	UpdateVisualsForPlayer();
}
</code></pre>

<p>The following code sample is from a simplified blackjack game I wrote for an assignment:</p>

<pre><code>protected override void Update(GameTime gameTime)
{
	MouseState mouseState = Mouse.GetState();
	foreach(var menuButton in menuButtons){
		if(currentState == GameState.WaitingForPlayer || currentState == GameState.DisplayingHandResults){
			menuButton.Update(mouseState);
		}
	}

	switch(currentState){
		case GameState.PlayerHitting:
			PlayerHit();
			break;
		case GameState.WaitingForDealer:
			DealerTurn();
			break;
		case GameState.DealerHitting:
			DealerHit();
			break;
		case GameState.CheckingHandOver:
			CheckHandOver();
			break;
		case GameState.DisplayingHandResults:
			break;
		case GameState.Exiting:
			Exit();
			break;
		default:
			break;
	}

	base.Update(gameTime);
}
</code></pre>

<p>Every time this method executes (which is happening very often), it’s getting information about the mouse which is stored in <code>mouseState</code>. This includes the X and Y position of the cursor, which button(s) are pressed, etc.</p>

<p>The blackjack game was designed around a DFA, the states of which are determined by each of the <code>GameState</code> enum values. If the game is in either of the two states where player input is awaited (<code>GameState.WaitingForPlayer</code> and <code>GameState.DisplayingHandResults</code>), it’s going to call the <code>Update</code> method on each menu button within the game, which will check if any of the buttons (such as the Hit, Stand, or Quit buttons) have been clicked. If the game is not in any of those states, it’s going to go through the switch statement and execute the appropriate code which represents the DFA transition. </p>

<h3 id="sprites">Sprites</h3>

<p>In 2D game programming, all objects in the world are displayed as sprites. Player characters, enemies the player fights, items the player gets, and other objects and entities in the world are displayed as sprites. Sprites are rectangles of varying sizes that have images placed on them.</p>

<p><img src="../../../../images/4-30-15/explosion.png" alt="Explosion spritesheet" title="An explosion spritesheet" /></p>

<p>An explosion spritesheet containing the sprites for an animation. Taken from Dr. Tim “Dr. T” Chamillard’s course Beginning Game Programming With C#</p>

<p>Sprites have a length and width, as well as a position. The position is usually the upper left corner of the sprite, but in some situations, the center point of the sprite is used.</p>

<h3 id="collision-detection">Collision Detection</h3>

<p>In order for games to be interesting, things need to happen when sprites interact with each other. Collision detection is a term used to describe when the game checks for when sprites intersect each other and what to do when that happens. In Super Mario Bros. if Mario walks into a goomba, he shrinks if he’s big or he dies if he’s small. However, if he jumps on the goomba, he’ll bounce back up and get points.</p>

<p><img src="../../../../images/4-30-15/collision.png" alt="Collision detection" title="Collision detection" /></p>

<p>In order for sprites to move on their own, they usually have a velocity. </p>

<p>TODO: velocity formula</p>

<h3 id="removing-unused-resources">Removing Unused Resources</h3>

<p>In a game where many objects appear on the screen, something must be done about those objects once they are off screen and will no longer come back on screen. The resources for those objects must be freed or else the game will suffer performance degredation. You may also run out of memory. A simple way of doing this is having an <code>IsActive</code> or <code>ReadyForDisposal</code> property on each object and set it to the appropriate value when it’s on or off screen. When the game updates, check for any unused resources lingering around and delete them.</p>

<h2 id="conclusion">Conclusion</h2>

<p>I have talked about some basic 2D game development concepts, as well as talked about some of the XNA Framework’s API. </p>

<h2 id="resources">Resources</h2>



		</section>

		
			<div id="disqus_thread"></div>
			<script type="text/javascript">
					/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
					var disqus_shortname = 'houseofblackandwhite'; // required: replace example with your forum shortname

					/* * * DON'T EDIT BELOW THIS LINE * * */
					(function() {
							var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
							dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
							(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
					})();
			</script>
			<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
		
	</div>

    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
</body>
</html>
